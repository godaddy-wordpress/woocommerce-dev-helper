"use strict";(function(){jQuery(document).ready(function(i){var l;return l=function(t){var n,_,o,e,a,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if("wc_dev_helper_get_memberships_bulk_generation_status"===t)e=wc_dev_helper_memberships_bulk_generation.get_memberships_bulk_generation_status_nonce,a=wc_dev_helper_memberships_bulk_generation.i18n.generation_success,n=wc_dev_helper_memberships_bulk_generation.i18n.generation_error,_=wc_dev_helper_memberships_bulk_generation.i18n.generation_in_progress;else{if("wc_dev_helper_get_memberships_bulk_destruction_status"!==t)return console.log("Invalid action: "+t),void console.log("Job ID: "+s);e=wc_dev_helper_memberships_bulk_generation.get_memberships_bulk_destruction_status_nonce,a=wc_dev_helper_memberships_bulk_generation.i18n.destruction_success,n=wc_dev_helper_memberships_bulk_generation.i18n.destruction_error,_=wc_dev_helper_memberships_bulk_generation.i18n.destruction_in_progress}return 0===i("p.bulk-generation-status .progress").length&&i("p.bulk-generation-status").append(' <span class="progress">'+_+"</span>"),n='<span class="error"   style="color: #DC3232;">&#10005;</span> '+n,a='<span class="success" style="color: #008000;">&#10004;</span> '+a,o={data:{action:t,security:e,job_id:s}},i.post(wc_dev_helper_memberships_bulk_generation.ajax_url,o.data).done(function(e){var s,r;return e.success?"completed"!==e.data.status?(s=e.data.progress?parseInt(e.data.progress,10):0,r=e.data.total?parseInt(e.data.total,10):0,i("p.bulk-generation-status .progress").html(_+" ("+s+" / "+r+")"),setTimeout(l(t,e.data&&e.data.id?e.data.id:null),1e5)):(i("#bulk-processing-memberships-spinner").removeClass("is-active"),i("p.bulk-generation-status").html(a),i("#process-memberships").prop("disabled",!1)):(i("p.bulk-generation-status").html(n+" "+e.data),i("#process-memberships").prop("disabled",!1),console.log("An error occurred while fetching the progress for the job: "+t),console.log("Request:"),console.log(o.data),console.log("Response:"),console.log(e.data))}).fail(function(e){return i("p.bulk-generation-status").html(n+" "+e.data),i("#bulk-processing-memberships-spinner").removeClass("is-active"),i("#process-memberships").prop("disabled",!1),console.log("Job failed: "+t),console.log("Request:"),console.log(o.data),console.log("Response:"),console.log(e&&e.data?e.data:e)})},wc_dev_helper_memberships_bulk_generation.is_bulk_generation_screen&&wc_dev_helper_memberships_bulk_generation.bulk_generation_job_in_progress&&l("wc_dev_helper_get_memberships_bulk_generation_status",wc_dev_helper_memberships_bulk_generation.bulk_generation_job_in_progress),wc_dev_helper_memberships_bulk_generation.is_bulk_destruction_screen&&wc_dev_helper_memberships_bulk_generation.bulk_destruction_job_in_progress&&l("wc_dev_helper_get_memberships_bulk_destruction_status",wc_dev_helper_memberships_bulk_generation.bulk_destruction_job_in_progress),i("#process-memberships").on("click",function(e){var s,r,t,n,_;if(e.preventDefault(),i(this).hasClass("generate-memberships"))s="wc_dev_helper_memberships_bulk_generate",_="wc_dev_helper_get_memberships_bulk_generation_status",t=wc_dev_helper_memberships_bulk_generation.start_memberships_bulk_generation_nonce,r=parseInt(i("#members-to-generate").val(),10);else{if(!i(this).hasClass("destroy-memberships"))return console.log("Unknown or undefined job to launch."),void console.log(i(this));s="wc_dev_helper_memberships_bulk_destroy",_="wc_dev_helper_get_memberships_bulk_destruction_status",t=wc_dev_helper_memberships_bulk_generation.start_memberships_bulk_destruction_nonce,r=0}return i(this).prop("disabled",!0),i("#bulk-processing-memberships-spinner").addClass("is-active"),n={data:{action:s,security:t,members_to_generate:r,min_memberships_per_user:0<r?Math.max(0,parseInt(i("#min-memberships-per-user").val(),10)):1,max_memberships_per_user:0<r?Math.max(1,parseInt(i("#max-memberships-per-user").val(),10)):3}},i.post(wc_dev_helper_memberships_bulk_generation.ajax_url,n.data,function(e){var s;return e.success?l(_,e.data&&e.data.id?e.data.id:null):(s='<span class="error" style="color: #DC3232;">&#10005;</span> '+(e.data?e.data:""),i("#bulk-processing-memberships-spinner").removeClass("is-active"),i("p.bulk-generation-status").html(s),i("#process-memberships").prop("disabled",!1),console.log("Could not start job: "+_),console.log("Request:"),console.log(n.data),console.log("Response:"),console.log(e.data))})})})}).call(void 0);
//# sourceMappingURL=wc-dev-helper-memberships-bulk-generation.min.js.map
